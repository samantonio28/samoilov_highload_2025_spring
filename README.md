# Samoilov - Highload 2025 autumn

Студент: Самойлов Антон Дмитриевич
Старший преподаватель: Александр Быков

# Tinder 
## 1. Тема и целевая аудитория
`Tinder` - сервис для онлайн-знакомств и планирования свиданий, имеющий клиенты на Android и IOS, а также веб-клиент. Учитывается геопозиция пользователей, интересы, а также применяется рекомендательная система на основе предыдущих действий пользователя. Главное действие - свайп, т.е. слистывание карточек других пользователей влево или вправо. На основании содержания карточки, в которой на фоне находится фото пользователя, а на переднем плане - информация о нём, такая как возраст, рост, местоположение, интересы, пользователь делает выбор: не понравилось - листает влево, захотелось пообщаться с этим человеком - листает вправо. В случае, если оба пользователя друг для друга выбрали свайп вправо, то у них появляется возможность в приложении пообщаться или найти место, чтобы пообщаться вживую.

## MVP
- Авторизация/Регистрация
- Заполнение профиля, редактирование профиля
- Взаимодействие с лентой карточек (просмотр данных + свайп)
- Установка фотографий 
- Общение в чате
- Выбор места для встречи
- Получение уведомлений о совпадениях

## Целевая аудитория
Ориентируясь на информацию с [сайта](https://datingzest.com/tinder-statistics/)
- DAU: 42 млн
- MAU: 75 млн
- Скачивания: более 530 млн раз
- Страна с наибольшим количеством пользователей: США

### Распределение по странам
Страна|Распределение (%)
---|---
США|9.6 млн
Британия|5 млн
Бразилия|7.2 млн

## 2. Расчёт нагрузки

### Продуктовые метрики
Метрика|Значение
---|---
DAU|42 млн
MAU|75 млн
Регистрация|530 млн
Совпадений в день|50 млн
Количество свайпов в день|> 2 млрд

### Количество операций по типам
Количество свайпов на одного пользователя в день = 2 млрд / 42 млн = 48 свайпов.
Предположим смену фотографии раз в месяц. Предположим, что общение в чатах происходит столько раз, сколько пользователь заходит в приложение в день.
В день суммарно пользователь в среднем отправляет около 9 сообщений в чат согласно [источнику](https://arxiv.org/pdf/1607.03320.pdf). Тогда количество сообщений это количество чатов, умноженное на 9.

Операция|Среднее количество в день на пользователя
---|---
Регистрация|0.0026
Заполнение и редактирование профиля|0.0026
Свайп влево/вправо|48
Смена фотографии|0.03
Общение в чате|11
Поиск места для встречи|0.0238
Получение уведомлений о совпадении|1.19
Отправка сообщения|99

### Технические метрики

Хранилище используется для данных пользователя (карточки/профиля) и сообщений, а также о свайпах.

Расчёт среднего размера профиля: персональные данные пользователя, никнейм, контакты (суммарно 2 КБ). Для хранения фото выделяется 410 КБ (размер фото 640*640) пикселей. Есть возможность загрузить 5 фото.

Из этого следует, что на одного пользователя требуется выделить 2 КБ + 5 * 410 КБ = 2052 КБ -> на всех 530 млн пользователей потребуется 

`530 млн * 2052 КБ = 1012 ТБ`

Расчёт затрат на сообщения: примем, что длина сообщения равна 50 символам, а один символ весит 2 байта, тогда вес сообщения равен в среднем 100 байт. За один день пользователь отправляет 99 сообщений. Переписки хранятся ~ полгода, поэтому хранилище будет занимать

`42 млн * 99 * 100 байт * 180 дней = 68 ТБ`

Свайп - это булево значение, которое весит 1 байт. Предположим, что свайпы хранятся в течение года для улучшения алгоритмов и аналитики

`42 млн * 48 * 1 * 365 = 685.3 ГБ`

Тип данных|Размер
---|---
Профили| 1012 ТБ
Сообщения| 68 ТБ
Свайпы| 685 ГБ

#### Расчёт RPS
Учитывая DAU = 42 млн, будем считать средний RPS по формуле `42 млн / 24 / 3600 * N`, где N - число операций определенного типа в день, а пиковый RPS будем считать как 6 * средний RPS (согласно [источнику](https://habr.com/ru/companies/mamba/articles/144084/))

Операция|Средний RPS|Пиковый RPS
---|:---:|:---:
Регистрация|1.26|7.57
Заполнение и редактирование профиля|1.26|7.57
Свайп влево/вправо|23 333.33|140 000.0
Смена фотографии|14.58|87.5
Общение в чате|5 347.22|32 083.33
Поиск места для встречи|11.57|69.44
Получение уведомлений о совпадении|578.47|3 470.83
Отправка сообщения|48 125.0|288 750.0
**Сумма**|**78 412.69**|**464 476.24**

#### Сетевой трафик

#### Регистрация
Средний размер фото при отправке считаем равным 2 MБ. При регистрации отправляют примерно 5 фото и данные о себе примерно на 2 КБ.
Общий объем данные при регистрации:

`2 КБ + 2 МБ * 5 ~= 10 МБ`

#### Заполнение и редактирование профиля
Около 2 КБ, текстовая информация.

#### Свайпы
На каждый свайп надо загрузить данные пользователя + 5 картинок для их листания, это `2 КБ + 5 * 410 КБ = 2052 КБ`.

#### Смена фотографии
Загрузка фото размером примерно 2 МБ.

#### Отправка сообщений
Средний размер сообщения приняли за 100 байт.

#### Поиск места для встречи
Представим, что есть какая-то выборка подходящих по локации мест. Одна позиция в этой выборке это геопозиция (2 числа типа double), а также некоторая текстовая информация о месте, а также большой набор картинок, позволящих оценить место для встречи. Информацией о месте можно пренебречь по сравнению с картинками. Допустим, каждая из них весит 3 МБ, их около 10, тогда для получения одной позиции в списке будет затрачено `30 МБ` трафика.

#### Получение уведомлений о совпадении
Предположим, что трафик совпадает с трафиком получения профиля пользователя (так как интересно узнать, с кем произошел метч).

#### Общение в чате
Получение чата с сообщениями - это получение сообщений за нынешний день, если зайти в середине дня, то пользователь совершил ~ 4 сессии и за них успел написать ~ 5 сообщений, то есть `500 байт`.

| Операция                    | Средний трафик, Гбит/с | Пиковый трафик, Гбит/с | Суточный трафик, Гбайт |
| ----------------------------| :--------------------: | :--------------------: | :--------------------: |
| Регистрация|0.098|0.59|1063.125|
| Заполнение и редактирование профиля|0.098|0.59|1063.125|
| Свайпы влево/вправо|365.29|2191.74|3945134.0|
| Смена фотографии|0.227|1.367|2460.375|
| Общение в чате|0.02|0.12|215.1|
| Поиск места для встречи|2.71|16.27|29286.5625|
| Получение уведомлений о совпадении|9.0562|54.337|97807.0|
| Отправка сообщения|0.358|2.15|3872.44|
| **Сумма**                   | **377.8572**           | **2267.1432**          | **4080901.73**    |

## 3. 

## Список использованных источников
1) https://affmaven.com/ru/tinder-statistics/
2) https://datingzest.com/tinder-statistics/
3) https://www.businessofapps.com/data/tinder-statistics/
4) https://www.demandsage.com/tinder-statistics/
